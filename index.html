<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="cover.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <title>Home</title>
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="index.html">TimeSlice</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#myNavbar" aria-controls="myNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html"><strong>Home</strong></a></li>
          <!-- <li class="nav-item"><a class="nav-link" href="setup.html"><strong>Get Started</strong></a></li> -->
          <li class="nav-item"><a class="nav-link" href="writeup.html"><strong>The Writeup</strong></a></li>
          <!-- <li class="nav-item"><a class="nav-link" href="code.html"><strong>The Code</strong></a></li> -->
           <li class="nav-item"><a class="nav-link" href="#" id="demoLink"><strong>Demo</strong></a></li>
        </ul>
      </div>
    </div>
  </nav>

    <div class="container-fluid text-center">
      <img src="images/TimeSlice_lesser.png" class="img-fluid mb-5" style="max-width: 90%; height: auto;" alt="TimeSlice logo and tagline">
    </div>

    <div class="container-fluid text-center">
      <!-- <h3 class=" ">Personalize your session.</h3> -->
      <h5 class=" ">Click on an image below to choose your experience.</h5>
      <!-- <p class="mb-5">Background image, sound, and time intervals are up to you.</p> -->

      <!-- <button class="mb-5" href="setup.html" type="button" onclick="location.href='setup.html'">
        Get Started
      </button> -->
    </div>

    <div class="container-fluid bg-3 text-center mb-5">
      <form>
        <div class="row">
          <!-- ROWBOAT -->
          <div class="col-12 col-sm-4 mb-4">
            <label class="text-center w-100" style="cursor:pointer;">
              <input type="radio" name="theme" id="rowboatLake" value="rowboatLake" class="d-none">
              <img src="/images/rowboatLake.png" class="img-fluid img-responsive w-100 mb-2" style="width:100%; border-radius:8px; border:2px solid #ccc;" alt="Lake">
              <div>Waves gently lapping at the lakeshore</div>
              <!-- <audio controls style="width:100px;">
                <source src="sound1.mp3" type="audio/mpeg">
              </audio> -->
            </label>
          </div>
          <!-- STONE CIRCLE -->
          <div class="col-12 col-sm-4 mb-4">
            <label class="text-center w-100" style="cursor:pointer;">
              <input type="radio" name="theme" id="stoneCircle" value="stoneCircle" class="d-none">
              <img src="/images/stoneCircle.png" class="img-fluid img-responsive w-100 mb-2" style="width:100%; border-radius:8px; border:2px solid #ccc;" alt="Stone Circle">
              <div>Nature sounds</div>
              <!-- <audio controls style="width:100px;">
                <source src="sound2.mp3" type="audio/mpeg">
              </audio> -->
            </label>
          </div>
          <!-- SHORELINE -->
          <div class="col-12 col-sm-4 mb-4">
            <label class="text-center w-100" style="cursor:pointer;">
              <input type="radio" name="theme" id="rockyShore" value="rockyShore" class="d-none">
              <img src="/images/rockyShore.png" class="img-fluid img-responsive w-100 mb-2" style="width:100%; border-radius:8px; border:2px solid #ccc;" alt="Rocky Shore">
              <div>Small ocean waves breaking on rocky shore</div>
              <!-- <audio controls style="width:100px;">
                <source src="sound3.mp3" type="audio/mpeg">
              </audio> -->
            </label>
          </div>
        </div>
      </form>
    </div>

  <!-- Footer -->
  <footer class="container-fluid footer bg-light text-center">
    <p>Bootstrap Theme By <a href="https://www.w3schools.com">www.w3schools.com</a>, Customized by Beth Olmo, M.S.</p>
  </footer>
  
  <!-- Timer Modal -->
  <div class="modal fade" id="timerModal" tabindex="-1" aria-labelledby="timerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content" style="background-size:cover; background-position:center;" id="modalBg">
        <div class="modal-header border-0">
          <!-- <h5 class="modal-title" id="timerModalLabel">Your Pomodoro Session</h5> -->
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center text-light">
          <!-- <img id="modalImage" src="" alt="" style="max-width:300px; border-radius:12px; margin-bottom:20px;"> -->
          <h2 id="timerDisplay" style="font-size:4rem; margin:20px 0;">2:00</h2>
          <audio id="modalAudio" controls style="width:200px; margin-bottom:20px;">
            <source id="audioSource" src="" type="">
          </audio>
          <div>
            <button id="startBtn" class="btn btn-success btn-lg">Start</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const themes = {
      rowboatLake: {
        img: "/images/rowboatLake2.png",
        sound: "/soundscapes/rowboatLake.mp3"
      },
      stoneCircle: {
        img: "/images/stoneCircle.png",
        sound: "/soundscapes/stoneCircle.mp3"
      },
      rockyShore: {
        img: "/images/rockyShore.png",
        sound: "/soundscapes/rockyShore.mp3"
      }
    };

    document.querySelectorAll('input[name="theme"]').forEach(input => {
      input.addEventListener('change', function() {
        const selected = themes[this.value];
        // Set modal background and content
        document.getElementById('modalBg').style.backgroundImage = `url('${selected.img}')`;
        // document.getElementById('modalImage').src = selected.img;
        document.getElementById('audioSource').src = selected.sound;
        document.getElementById('modalAudio').load();
        document.getElementById('timerDisplay').textContent = "25:00";
        // Show modal
        const modal = new bootstrap.Modal(document.getElementById('timerModal'));
        modal.show();
      });
    });

    // Simple Pomodoro timer logic
    let timerInterval;
    let timerRunning = false;
    let isWorkSession = true;
    let demoMode = false;

    const startBtn = document.getElementById('startBtn');

    // Theme selection logic
    document.querySelectorAll('input[name="theme"]').forEach(input => {
      input.addEventListener('change', function() {
        demoMode = false; // Reset demo mode if user picks a theme
        isWorkSession = true;
        timerRunning = false;
        clearInterval(timerInterval);
        startBtn.textContent = "Start";
        const selected = themes[this.value];
        document.getElementById('modalBg').style.backgroundImage = `url('${selected.img}')`;
        document.getElementById('audioSource').src = selected.sound;
        document.getElementById('modalAudio').load();
        document.getElementById('timerDisplay').textContent = "25:00";
        const modal = new bootstrap.Modal(document.getElementById('timerModal'));
        modal.show();
      });
    });

    // Timer logic
    function startTimer(minutes, seconds) {
      timerRunning = true;
      startBtn.textContent = "Stop";
      document.getElementById('timerDisplay').textContent =
        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      clearInterval(timerInterval);

      timerInterval = setInterval(() => {
        if (!timerRunning) {
          clearInterval(timerInterval);
          return;
        }
        if (minutes === 0 && seconds === 0) {
          clearInterval(timerInterval);
          const audio = document.getElementById('modalAudio');
          if (isWorkSession) {
            // Work session ended, start break
            isWorkSession = false;
            audio.loop = false;
            audio.pause();
            startTimer(demoMode ? 0 : 5, demoMode ? 30 : 0); // 5:00 or 0:30 break
          } else {
            // Break ended, start work session again
            isWorkSession = true;
            audio.loop = true;
            audio.currentTime = 0;
            audio.play();
            startTimer(demoMode ? 0 : 25, demoMode ? 30 : 0); // 25:00 or 0:30 work
          }
          return;
        }
        if (seconds === 0) {
          minutes--; seconds = 59;
        } else {
          seconds--;
        }
        document.getElementById('timerDisplay').textContent =
          `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      }, 1000);
    }

    // Start/Stop button logic
    startBtn.addEventListener('click', function() {
      const audio = document.getElementById('modalAudio');
      if (!timerRunning) {
        if (isWorkSession) {
          audio.loop = true;
          audio.currentTime = 0;
          audio.play();
          startTimer(demoMode ? 0 : 25, demoMode ? 30 : 0);
        } else {
          startTimer(demoMode ? 0 : 5, demoMode ? 30 : 0);
        }
      } else {
        timerRunning = false;
        clearInterval(timerInterval);
        audio.pause();
        audio.loop = false;
        startBtn.textContent = "Start";
      }
    });

    // Demo link logic
    document.getElementById('demoLink').addEventListener('click', function(e) {
  e.preventDefault();
  demoMode = true;
  isWorkSession = true;
  timerRunning = false;
  clearInterval(timerInterval);
  startBtn.textContent = "Stop";
  document.getElementById('modalBg').style.backgroundImage = "url('/images/rowboatLake2.png')";
  document.getElementById('audioSource').src = "/soundscapes/rowboatLake.mp3";
  document.getElementById('modalAudio').load();
  document.getElementById('timerDisplay').textContent = "00:30";
  const modal = new bootstrap.Modal(document.getElementById('timerModal'));
  modal.show();
  // Start demo timer automatically
  const audio = document.getElementById('modalAudio');
  audio.loop = true;
  audio.currentTime = 0;
  audio.play();
  startTimer(0, 30);
});
  </script>
  
</body>
</html>